# 用户交互：移动物体

> 交互动画的一个主要目标是创建出流畅的用户体验，其中大多数的用户交互都是通过鼠标和触摸屏实现的。

## 按下及释放物体

在动画中，鼠标事件只能被`canvas`元素所捕获。因此，需要手动计算鼠标事件在`canvas`上的位置并判断它发生在哪个物体上。

常用鼠标事件：

- `mousedown`: 当鼠标指针位于某个 HTML 元素上方时按下鼠标按钮触发该事件。
- `mouseup`: 当鼠标指针位于某个 HTML 元素上方时释放鼠标按钮触发该事件。
- `mousemove`: 当鼠标指针位于某个 HTML 元素上方时移动鼠标触发该事件。

## 使用触摸事件

- `touchstart`: 在第一次触摸时触发。
- `touchend`: 在一个手指离开触摸屏时触发。
- `touchmove`: 手指在屏幕上拖动时触发。

[W3C 规范](http://www.w3.org/TR/touch-events)

在触摸事件的监听器中调用`event.preventDefault()`方法，会让浏览器在事件处理函数执行完成后继续处理该事件。同时还会阻止与触摸事件对应的鼠标事件的触发，这是该方法的默认行为，**不过最好不要太依赖这一特性**

## 拖拽对象

通过不断更新物体的坐标位置使其追随鼠标指针的位置，就可以实现在`canvas`元素上拖拽物体。

实现代码包含以下过程： 捕捉 `mousedown` 事件，当鼠标单击小球时为 `canvas` 添加 `mousemove` 事件的处理程序，并在该处理程序内将小球的 x，y 坐标更新为鼠标指针当前的坐标位置，最后，在 `mouseup` 事件触发时，将 `mousemove` 事件的处理程序移除。

### 投掷

用鼠标选中一个物体，拖拽着它向某个方向移动，松开鼠标后物体沿拖拽的方向继续移动。

在投掷物体时，必须在拖拽物体的过程中计算物体的速度向量，并在释放物体时将这个速度向量赋给物体。

在对物体应用速度向量是，将速度向量追加到物体原来所在的位置上从而计算出物体的新位置。这个公式可以写成：旧的位置 + 速度向量 = 新的位置。

要计算出物体被拖拽时的速度向量，只需将这个等式做一个简单的变形：速度向量 = 新的位置 - 旧的位置。

在拖拽物体时，它会在每一帧拥有一个新的位置。用当前帧的位置加上上一帧的位置，就可以计算出在这一帧所移动的距离。这就是每帧移动响度的速度向量值。
